<div class="community-banner">
  <% if (community.coverImage) { %>
  <img src="<%= community.coverImage %>" alt="Community Cover">
  <% } %>
  <h1><%= community.name %></h1>
  <p><%= community.description %></p>
  <p><strong>Category:</strong> <%= community.category %></p>
  <p><strong>Tags:</strong> <%= community.tags.join(', ') %></p>
</div>

<div class="community-meta">
  <p><strong>Owner:</strong> <%= community.owner.username %></p>
  <p><strong>Members:</strong> <%= community.members.length %></p>
</div>

<% if (!isMember && !hasRequested) { %>
  <form action="/communities/<%= community._id %>/request" method="POST">
    <button type="submit" class="btn">Request to Join</button>
  </form>
<% } else if (hasRequested) { %>
  <p><em>Join request pending</em></p>
<% } else { %>
  <p><em>You are a member of this community</em></p>
<% } %>

<section class="community-posts">
    <h2>Community Feed</h2>
    <% if (posts.length === 0) { %>
    <p>No posts yet. Be the first to post!</p>
    <% } else { %>
    <ul class="post-list">
      <% posts.forEach(post => { %>
      <li class="post-item">
        <h3><%= post.title %></h3>
        <p><%= post.body %></p>
        <p class="post-meta">Posted by <strong><%= post.author.username %></strong> on <%= new Date(post.createdAt).toLocaleString() %></p>

        <% if (userId === post.author._id.toString() || userId === community.owner._id.toString()) { %>
        <form action="/communities/<%= community._id %>/posts/<%= post._id %>/delete" method="POST" style="display:inline;">
          <button type="submit" class="btn-delete">ðŸ—‘ Delete</button>
        </form>
        <% } %>
      </li>
      <% }); %>
    </ul>
    <% } %>
</section>

<% if (isMember) { %>
<div class="member-section">
  <h3>ðŸ‘‹ Welcome back, member!</h3>
  <!-- Add member-only content here -->
</div>
<% } else if (isLoggedIn) { %>
<form action="/communities/<%= community._id %>/join" method="POST">
  <button type="submit">Join Community</button>
</form>
<% } else { %>
<p><a href="/login">Log in</a> to join this community.</p>
<% } %>